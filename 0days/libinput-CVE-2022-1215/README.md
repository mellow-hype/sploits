# CVE-2022-1215 libinput/Xorg Format String Vulnerability

NOTE: the exploits provided for this vulnerability exploit code related to handling of USB devices
and require the use of special hardware to emulate malicious USB devices. these exploits are
compatible with Greatfet/Facedancer compatible hardware.

## Canary Leak Exploit

The info leak exploits provided can be used to leak stack canaries on Xubuntu 20.04 and Debian 11
default installations.

## RCE Exploit Primitives

By default, Xorg and libinput used on the majority of Linux distros are compiled with exploit
mitigations enabled, including `FORTIFY_SOURCE=2`, which makes exploitation of format string
vulnerabilities to achieve code execution extremely difficult. I began the work of developing a code
execution exploit against a version of the code built without the `FORTIFY_SOURCE` flag but
eventually ran into issues due to the use of UTF-16 in the USB protocol and the effects that has on
payload data. Specifically, addresses and shell code would be corrupted by the encoding by the time
the vulnerable code processed the data. I've yet to go back to this to find a solution to this
issue, but I've included the scripts/code I used to leak base pointer addresses and calculate the
location of the payload data in memory.
