# CVE-2023-33476: MiniDLNA 1.3.2 Heap Overflow

See blog posts here for more details:
- https://blog.coffinsec.com/0day/2023/05/31/minidlna-heap-overflow-rca.html

## exploit 1: tcache poisoning to GOT overwrite -> reverse shell

- OS: Debian 11
- Arch: x86_64
- Glibc: 2.31
- Partial RELRO, no PIE
- `system()` addr and GOT addr assumed known

```
usage: tpoison-nopie-x64_reverse-shell.py [-h] [--target_port TARGET_PORT] [--lhost LHOST] [--lport LPORT] [--system_addr SYSTEM_ADDR] [--got_addr GOT_ADDR] target_ip

miniDLNA 1.3.2 Heap OOB r/w RCE exploit -> reverse shell (by @hyprdude)

positional arguments:
  target_ip             IP address of host running the service

options:
  -h, --help            show this help message and exit
  --target_port TARGET_PORT
                        Target port (default: 8200)
  --lhost LHOST         Bind IP for reverse shell listener (default: 10.10.13.20)
  --lport LPORT         Bind port for reverse shell listener (default: 1337)
  --system_addr SYSTEM_ADDR
                        Address to overwrite GOT entry with (defaults to system() at 0x7ffff61ee020)
  --got_addr GOT_ADDR   Address of the GOT (default: 0x45c118)

```

## exploit 2: tcache poisoning to pivot2stack RIP overwrite

- Target: Netgear RAX30 minidlna binary running via QEMU
- Arch: arm32
- Full RELRO
- `system()` addr and stack addr assumed known
